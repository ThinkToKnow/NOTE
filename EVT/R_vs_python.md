# GEV
```shell
library(evir)
set.seed(1234)
data<-rgev(100,xi=2,mu=3,sigma=0.5)
out1<-gev(data,1)
print(out1)
out2<-gev(data,1,method="BFGS")
print(out2)


$par.ests
       xi     sigma        mu 
1.7748954 0.2843106 2.9128438 

$par.ses
        xi      sigma         mu 
0.19100832 0.06495368 0.03308848 

$par.ests
       xi     sigma        mu 
 3.878318 27.636424  9.883546 

$par.ses
         xi       sigma          mu 
0.001910969 0.127087141 0.033223971 


from scipy.stats import genpareto, genextreme
from time import time
data=[2.802888 ,   3.861147 ,   3.768304  ,  3.869316  , 13.896893   , 4.007929  ,  2.761528  ,  2.867500  ,  4.264123,
3.315249 ,   4.617586 ,   3.428485  ,  2.906661  , 42.150115   , 2.915267  , 10.677958  ,  2.909749  ,  2.893224,
2.838775 ,   2.867276 ,   2.939011  ,  2.925057  ,  2.823958   , 2.774127  ,  2.858263  ,  8.419887  ,  3.354615,
34.166866,   10.077529,    2.776283 ,   3.155632 ,   2.891902  ,  2.926982 ,   3.292828 ,   2.835624 ,   6.058905,
2.847265 ,   2.886837 ,4028.313321  ,  8.209242  ,  3.463836   , 4.063152  ,  2.934100  ,  3.857539  ,  2.953140,
3.276380 ,   4.394124 ,   3.227434  ,  2.875592  ,  6.249546   , 2.786793  ,  2.931945  ,  5.014008  ,  3.284202,
2.820935 ,   3.282310 ,   3.252567  ,  5.804609  ,  2.832104   ,11.998536  , 14.604951  ,  2.774824  ,  2.939603,
2.763605 ,   2.872053 ,   4.821005  ,  2.930356  ,  3.296757   , 2.778469  ,  3.514922  ,  2.806260  , 22.207279,
2.764006 ,   6.933081 ,   2.793101  ,  3.331854  ,  3.023303   , 2.785372  ,  2.943240  ,  4.291421  , 45.526010,
3.193300 ,   2.815908 ,   3.425600  ,  2.844239  , 24.610889   , 3.031201  ,  2.933136  ,  2.824456  , 23.559408,
2.827730 ,  25.473820 ,   2.811921  ,  2.810793  ,  2.799336   , 3.306511  ,  2.922657  ,  2.769052  ,  2.931906,
5.560569]
data=np.array(data)
c,loc,scale = genextreme.fit(data)
print(-c,loc,scale)


xi:1.0128907922132098 mu:2.9283343828954003 sigma:0.22776426316190201
```



```shell
library(evir)
set.seed(1234)
data<-c(2.84152028e+00, 3.85971316e+00, 3.11628034e+00, 7.03245381e+00,
       6.79868394e+00, 2.89797978e+00, 2.90124411e+00, 7.87764580e+00,
       1.39467153e+02, 1.69972341e+01, 2.98668980e+00, 3.27334031e+00,
       4.47600312e+00, 4.92936760e+00, 3.00324384e+00, 3.49913181e+00,
       3.27969614e+00, 2.76361326e+00, 6.51451752e+00, 1.87919348e+01,
       2.99596435e+00, 3.81067217e+00, 2.78740699e+00, 3.00128710e+00,
       5.49570005e+01, 4.11051733e+00, 3.04325539e+00, 7.18844580e+00,
       2.93924301e+00, 3.53187250e+00, 1.54568481e+01, 3.11314641e+00,
       7.89363539e+00, 2.81645573e+00, 4.78376417e+00, 4.78905022e+00,
       2.85825860e+00, 4.37313407e+01, 3.12533972e+00, 3.04143280e+01,
       2.78151310e+00, 2.83740152e+00, 2.77687314e+00, 4.36685493e+00,
       3.67517991e+00, 3.38258554e+00, 2.77537140e+00, 3.50022758e+00,
       2.95302710e+00, 3.27933970e+00, 2.80211614e+00, 3.75438469e+00,
       3.52147203e+00, 2.76001549e+00, 3.82532200e+00, 3.22993523e+01,
       7.27465940e+00, 3.95823809e+03, 1.43995821e+02, 7.34554504e+00,
       2.90888309e+00, 3.88107476e+00, 3.20907970e+00, 2.84394480e+00,
       3.02041939e+00, 2.77929836e+00, 3.14570203e+00, 7.60889893e+02,
       2.80734634e+00, 2.80534061e+00, 5.47119498e+00, 3.63260933e+00,
       3.19260705e+00, 2.80010419e+00, 2.86520936e+00, 2.52542981e+01,
       3.07633645e+00, 3.39226307e+00, 2.75968053e+00, 2.92308106e+00,
       3.11459399e+00, 3.78792760e+00, 3.70751875e+01, 3.88741062e+00,
       4.81264007e+00, 2.81938135e+00, 5.66318971e+00, 1.00453658e+01,
       3.95156059e+00, 3.11746166e+00, 2.82072482e+00, 3.53338801e+00,
       3.36373332e+00, 1.03593449e+02, 3.21501828e+00, 3.27809400e+00,
       3.39622169e+00, 9.03612451e+00, 2.78050670e+00, 4.30207582e+00)
out1<-gev(data,1)
print(out1)
out2<-gev(data,1,method="BFGS")
print(out2)


$par.ests
       xi     sigma        mu 
1.9154374 0.5598771 3.0378512 

$par.ses
        xi      sigma         mu 
0.20765272 0.13589141 0.06512091 
$par.ests
       xi     sigma        mu 
19.526141 74.143775  6.556183 

$par.ses
          xi        sigma           mu 
         NaN          NaN 2.000364e-06 
         
         
seed=1234
np.random.seed(seed)
random.seed(seed)
rvs = genextreme.rvs(c=-2 ,loc=3,scale=0.5,size=100)
c,loc,scale = genextreme.fit(rvs)
print(-c,loc,scale)
print(rvs)
xi:0.985006196939567 mu:3.0928381601146153 sigma:0.4664235019412498
```



# GPD

```shell
library(evir)
set.seed(1234)
data<-rgpd(100,xi=1,mu=3,beta=2)
out1<-gpd(data,0)
print(out1)

$par.ests
       xi      beta 
0.2109841 6.3075499 

$par.ses
        xi       beta 
0.07273328 0.76853847 


seed=1234
np.random.seed(seed)
random.seed(seed)
data=[3.256581  , 6.295199 ,  6.118686 ,  6.310385 , 15.379736 ,  6.560353 ,  3.019174 ,  3.606035 ,  6.989526 ,  5.117354,
7.527230  , 5.395361 ,  3.788364 , 27.121079 ,  3.826119 , 13.292233 ,  3.801997 ,  3.727846 ,  3.459186 ,  3.604933,
3.926597  , 3.868179 ,  3.378251 ,  3.083324 ,  3.560162 , 11.559581 ,  5.216719 , 24.435165 , 12.858531 ,  3.095931,
4.677089  , 3.721780 ,  3.876341 ,  5.059322 ,  3.442289 ,  9.321913 ,  3.503906 ,  3.698363 ,255.790622 , 11.381647,
5.477615  , 6.656206 ,  3.906235 ,  6.288476 ,  3.984051 ,  5.016044 ,  7.193763 ,  4.883429 ,  3.645254 ,  9.527322,
3.159314  , 3.897235 ,  8.073930 ,  5.036701 ,  3.361272 ,  5.031717 ,  4.952264 ,  9.038592 ,  3.423214 , 14.191952,
15.796602 ,  3.087372,   3.929039,   3.027883,   3.628210,   7.814185,   3.890569,   5.069570,   3.108919,   5.593159,
3.276557  ,19.663050 ,  3.029689 , 10.221736 ,  3.197709 ,  5.159647 ,  4.248159 ,  3.150659 ,  3.943966 ,  7.033099,
28.174089 ,  4.787231,   3.332675,   5.388561,   3.488103,  20.720071,   4.276002,   3.902213,   3.381034,  20.265196,
3.399214  ,21.085281 ,  3.309677 ,  3.303124 ,  3.235355 ,  5.094866 ,  3.857956 ,  3.054901 ,  3.897070 ,  8.755535]
data=np.array(data)

c,loc,scale = genpareto.fit(data)
print(c,loc,scale)

0.8365465700309074 3.0191739996924105 1.469340878072087
```



```shell
rvs = genpareto.rvs(c=1,loc=3,scale=2,size=100)
c,loc,scale = genpareto.fit(data)
print(c,loc,scale)
print(rvs)

xi:0.8365465700309074 loc:3.0191739996924105 sigma:1.469340878072087


library(evir)
set.seed(1234)
data=c(3.47377627,   6.29252824,   4.55699567,  10.31786621,
        10.08990954,   3.74949088,   3.76420345,  11.09449342,
        48.77757096,  17.12027463,   4.11437836,   5.00797688,
         7.31837539,   7.96141354,   4.17586724,   5.55784553,
         5.02481836,   3.02792133,   9.80384847,  18.04175435,
         4.14904088,   6.20015634,   3.16305367,   4.16868832,
        30.9132972 ,   6.73687496,   4.31786422,  10.46656578,
         3.92755525,   5.63068711,  16.28203643,   4.54719001,
        11.10854771,   3.33581232,   7.76271917,   7.77005232,
         3.56013798,  27.61968421,   4.58513374,  23.05459723,
         3.12722784,   3.451843  ,   3.09941855,   7.15159266,
         5.93370068,   5.28550151,   3.09057208,   5.56030747,
         3.98359817,   5.02387634,   3.25198424,   6.09156811,
         5.60770722,   3.01362025,   6.22796145,  23.75905431,
        10.54763921, 253.57200987,  49.54576566,  10.61372695,
         3.79818494,   6.33214896,   4.8321062 ,   3.4865576 ,
         4.23790919,   3.11388265,   4.64729497, 112.14038748,
         3.28295569,   3.27112948,   8.64885795,   5.84617787,
         4.78524442,   3.23995976,   3.5947693 ,  20.99304139,
         4.42908209,   5.30896728,   3.01249461,   3.85976447,
         4.55172394,   6.15661938,  25.4493025 ,   6.34383104,
         7.80266475,   3.35248096,   8.87598193,  12.8348092 ,
         6.46038959,   4.56068219,   3.36008467,   5.63402353,
         5.2393025 ,  42.17663363,   4.84881233,   5.02058187,
         5.3185183 ,  12.06207337,   3.12115089,   7.05000468)
out1<-gpd(data,0)
print(out1)

$par.ests
       xi      beta 
0.2109841 6.3075499 

$par.ses
        xi       beta 
0.07273328 0.76853847 
```





# GEV


```R
library(evir)
set.seed(1234)
data<-rgev(100,xi=2,mu=3,sigma=0.5)
out1<-gev(data,1)
print(out1)
out2<-gev(data,1,method="BFGS")
print(out2)
```



```R
> library(evir)
> set.seed(1234)
> data<-rgev(100,xi=2,mu=3,sigma=0.5)
> out1<-gev(data,1)
> print(out1)
$n.all
[1] 100

$n
[1] 100

$data
  [1]    2.802888    3.861147    3.768304    3.869316   13.896893    4.007929    2.761528    2.867500    4.264123
 [10]    3.315249    4.617586    3.428485    2.906661   42.150115    2.915267   10.677958    2.909749    2.893224
 [19]    2.838775    2.867276    2.939011    2.925057    2.823958    2.774127    2.858263    8.419887    3.354615
 [28]   34.166866   10.077529    2.776283    3.155632    2.891902    2.926982    3.292828    2.835624    6.058905
 [37]    2.847265    2.886837 4028.313321    8.209242    3.463836    4.063152    2.934100    3.857539    2.953140
 [46]    3.276380    4.394124    3.227434    2.875592    6.249546    2.786793    2.931945    5.014008    3.284202
 [55]    2.820935    3.282310    3.252567    5.804609    2.832104   11.998536   14.604951    2.774824    2.939603
 [64]    2.763605    2.872053    4.821005    2.930356    3.296757    2.778469    3.514922    2.806260   22.207279
 [73]    2.764006    6.933081    2.793101    3.331854    3.023303    2.785372    2.943240    4.291421   45.526010
 [82]    3.193300    2.815908    3.425600    2.844239   24.610889    3.031201    2.933136    2.824456   23.559408
 [91]    2.827730   25.473820    2.811921    2.810793    2.799336    3.306511    2.922657    2.769052    2.931906
[100]    5.560569

$block
[1] 1

$par.ests
       xi     sigma        mu 
1.7748954 0.2843106 2.9128438 

$par.ses
        xi      sigma         mu 
0.19100832 0.06495368 0.03308848 

$varcov
              [,1]        [,2]          [,3]
[1,]  0.0364841778 0.003254401 -0.0006883464
[2,]  0.0032544014 0.004218981  0.0019899902
[3,] -0.0006883464 0.001989990  0.0010948474

$converged
[1] 0

$nllh.final
[1] 132.3439

attr(,"class")
[1] "gev"
> out2<-gev(data,1,method="BFGS")
> print(out2)
$n.all
[1] 100

$n
[1] 100

$data
  [1]    2.802888    3.861147    3.768304    3.869316   13.896893    4.007929    2.761528    2.867500    4.264123
 [10]    3.315249    4.617586    3.428485    2.906661   42.150115    2.915267   10.677958    2.909749    2.893224
 [19]    2.838775    2.867276    2.939011    2.925057    2.823958    2.774127    2.858263    8.419887    3.354615
 [28]   34.166866   10.077529    2.776283    3.155632    2.891902    2.926982    3.292828    2.835624    6.058905
 [37]    2.847265    2.886837 4028.313321    8.209242    3.463836    4.063152    2.934100    3.857539    2.953140
 [46]    3.276380    4.394124    3.227434    2.875592    6.249546    2.786793    2.931945    5.014008    3.284202
 [55]    2.820935    3.282310    3.252567    5.804609    2.832104   11.998536   14.604951    2.774824    2.939603
 [64]    2.763605    2.872053    4.821005    2.930356    3.296757    2.778469    3.514922    2.806260   22.207279
 [73]    2.764006    6.933081    2.793101    3.331854    3.023303    2.785372    2.943240    4.291421   45.526010
 [82]    3.193300    2.815908    3.425600    2.844239   24.610889    3.031201    2.933136    2.824456   23.559408
 [91]    2.827730   25.473820    2.811921    2.810793    2.799336    3.306511    2.922657    2.769052    2.931906
[100]    5.560569

$block
[1] 1

$par.ests
       xi     sigma        mu 
 3.878318 27.636424  9.883546 

$par.ses
         xi       sigma          mu 
0.001910969 0.127087141 0.033223971 

$varcov
              [,1]          [,2]          [,3]
[1,]  3.651804e-06 -0.0001556831 -4.551532e-05
[2,] -1.556831e-04  0.0161511414  4.183968e-03
[3,] -4.551532e-05  0.0041839678  1.103832e-03

$converged
[1] 0

$nllh.final
[1] 216.463

attr(,"class")
[1] "gev"

```



```python
from scipy.stats import genpareto, genextreme
from time import time
data=[2.802888 ,   3.861147 ,   3.768304  ,  3.869316  , 13.896893   , 4.007929  ,  2.761528  ,  2.867500  ,  4.264123,
3.315249 ,   4.617586 ,   3.428485  ,  2.906661  , 42.150115   , 2.915267  , 10.677958  ,  2.909749  ,  2.893224,
2.838775 ,   2.867276 ,   2.939011  ,  2.925057  ,  2.823958   , 2.774127  ,  2.858263  ,  8.419887  ,  3.354615,
34.166866,   10.077529,    2.776283 ,   3.155632 ,   2.891902  ,  2.926982 ,   3.292828 ,   2.835624 ,   6.058905,
2.847265 ,   2.886837 ,4028.313321  ,  8.209242  ,  3.463836   , 4.063152  ,  2.934100  ,  3.857539  ,  2.953140,
3.276380 ,   4.394124 ,   3.227434  ,  2.875592  ,  6.249546   , 2.786793  ,  2.931945  ,  5.014008  ,  3.284202,
2.820935 ,   3.282310 ,   3.252567  ,  5.804609  ,  2.832104   ,11.998536  , 14.604951  ,  2.774824  ,  2.939603,
2.763605 ,   2.872053 ,   4.821005  ,  2.930356  ,  3.296757   , 2.778469  ,  3.514922  ,  2.806260  , 22.207279,
2.764006 ,   6.933081 ,   2.793101  ,  3.331854  ,  3.023303   , 2.785372  ,  2.943240  ,  4.291421  , 45.526010,
3.193300 ,   2.815908 ,   3.425600  ,  2.844239  , 24.610889   , 3.031201  ,  2.933136  ,  2.824456  , 23.559408,
2.827730 ,  25.473820 ,   2.811921  ,  2.810793  ,  2.799336   , 3.306511  ,  2.922657  ,  2.769052  ,  2.931906,
5.560569]
data=np.array(data)
c,loc,scale = genextreme.fit(data)
print(-c,loc,scale)
```

```python
xi:1.0128907922132098 mu:2.9283343828954003 sigma:0.22776426316190201
```



```R
library(evir)
set.seed(1234)
data<-c(2.84152028e+00, 3.85971316e+00, 3.11628034e+00, 7.03245381e+00,
       6.79868394e+00, 2.89797978e+00, 2.90124411e+00, 7.87764580e+00,
       1.39467153e+02, 1.69972341e+01, 2.98668980e+00, 3.27334031e+00,
       4.47600312e+00, 4.92936760e+00, 3.00324384e+00, 3.49913181e+00,
       3.27969614e+00, 2.76361326e+00, 6.51451752e+00, 1.87919348e+01,
       2.99596435e+00, 3.81067217e+00, 2.78740699e+00, 3.00128710e+00,
       5.49570005e+01, 4.11051733e+00, 3.04325539e+00, 7.18844580e+00,
       2.93924301e+00, 3.53187250e+00, 1.54568481e+01, 3.11314641e+00,
       7.89363539e+00, 2.81645573e+00, 4.78376417e+00, 4.78905022e+00,
       2.85825860e+00, 4.37313407e+01, 3.12533972e+00, 3.04143280e+01,
       2.78151310e+00, 2.83740152e+00, 2.77687314e+00, 4.36685493e+00,
       3.67517991e+00, 3.38258554e+00, 2.77537140e+00, 3.50022758e+00,
       2.95302710e+00, 3.27933970e+00, 2.80211614e+00, 3.75438469e+00,
       3.52147203e+00, 2.76001549e+00, 3.82532200e+00, 3.22993523e+01,
       7.27465940e+00, 3.95823809e+03, 1.43995821e+02, 7.34554504e+00,
       2.90888309e+00, 3.88107476e+00, 3.20907970e+00, 2.84394480e+00,
       3.02041939e+00, 2.77929836e+00, 3.14570203e+00, 7.60889893e+02,
       2.80734634e+00, 2.80534061e+00, 5.47119498e+00, 3.63260933e+00,
       3.19260705e+00, 2.80010419e+00, 2.86520936e+00, 2.52542981e+01,
       3.07633645e+00, 3.39226307e+00, 2.75968053e+00, 2.92308106e+00,
       3.11459399e+00, 3.78792760e+00, 3.70751875e+01, 3.88741062e+00,
       4.81264007e+00, 2.81938135e+00, 5.66318971e+00, 1.00453658e+01,
       3.95156059e+00, 3.11746166e+00, 2.82072482e+00, 3.53338801e+00,
       3.36373332e+00, 1.03593449e+02, 3.21501828e+00, 3.27809400e+00,
       3.39622169e+00, 9.03612451e+00, 2.78050670e+00, 4.30207582e+00)
out1<-gev(data,1)
print(out1)
out2<-gev(data,1,method="BFGS")
print(out2)

```



```R
$n.all
[1] 100

$n
[1] 100

$data
  [1]    2.841520    3.859713    3.116280    7.032454    6.798684    2.897980    2.901244    7.877646  139.467153
 [10]   16.997234    2.986690    3.273340    4.476003    4.929368    3.003244    3.499132    3.279696    2.763613
 [19]    6.514518   18.791935    2.995964    3.810672    2.787407    3.001287   54.957000    4.110517    3.043255
 [28]    7.188446    2.939243    3.531872   15.456848    3.113146    7.893635    2.816456    4.783764    4.789050
 [37]    2.858259   43.731341    3.125340   30.414328    2.781513    2.837402    2.776873    4.366855    3.675180
 [46]    3.382586    2.775371    3.500228    2.953027    3.279340    2.802116    3.754385    3.521472    2.760015
 [55]    3.825322   32.299352    7.274659 3958.238090  143.995821    7.345545    2.908883    3.881075    3.209080
 [64]    2.843945    3.020419    2.779298    3.145702  760.889893    2.807346    2.805341    5.471195    3.632609
 [73]    3.192607    2.800104    2.865209   25.254298    3.076336    3.392263    2.759681    2.923081    3.114594
 [82]    3.787928   37.075187    3.887411    4.812640    2.819381    5.663190   10.045366    3.951561    3.117462
 [91]    2.820725    3.533388    3.363733  103.593449    3.215018    3.278094    3.396222    9.036125    2.780507
[100]    4.302076

$block
[1] 1

$par.ests
       xi     sigma        mu 
1.9154374 0.5598771 3.0378512 

$par.ses
        xi      sigma         mu 
0.20765272 0.13589141 0.06512091 

$varcov
             [,1]        [,2]         [,3]
[1,]  0.043119652 0.007337513 -0.001362688
[2,]  0.007337513 0.018466474  0.008239717
[3,] -0.001362688 0.008239717  0.004240733

$converged
[1] 0

$nllh.final
[1] 206.0931

attr(,"class")
[1] "gev"
> out2<-gev(data,1,method="BFGS")
Warning message:
In sqrt(diag(varcov)) : 产生了NaNs
> print(out2)
$n.all
[1] 100

$n
[1] 100

$data
  [1]    2.841520    3.859713    3.116280    7.032454    6.798684    2.897980    2.901244    7.877646  139.467153
 [10]   16.997234    2.986690    3.273340    4.476003    4.929368    3.003244    3.499132    3.279696    2.763613
 [19]    6.514518   18.791935    2.995964    3.810672    2.787407    3.001287   54.957000    4.110517    3.043255
 [28]    7.188446    2.939243    3.531872   15.456848    3.113146    7.893635    2.816456    4.783764    4.789050
 [37]    2.858259   43.731341    3.125340   30.414328    2.781513    2.837402    2.776873    4.366855    3.675180
 [46]    3.382586    2.775371    3.500228    2.953027    3.279340    2.802116    3.754385    3.521472    2.760015
 [55]    3.825322   32.299352    7.274659 3958.238090  143.995821    7.345545    2.908883    3.881075    3.209080
 [64]    2.843945    3.020419    2.779298    3.145702  760.889893    2.807346    2.805341    5.471195    3.632609
 [73]    3.192607    2.800104    2.865209   25.254298    3.076336    3.392263    2.759681    2.923081    3.114594
 [82]    3.787928   37.075187    3.887411    4.812640    2.819381    5.663190   10.045366    3.951561    3.117462
 [91]    2.820725    3.533388    3.363733  103.593449    3.215018    3.278094    3.396222    9.036125    2.780507
[100]    4.302076

$block
[1] 1

$par.ests
       xi     sigma        mu 
19.526141 74.143775  6.556183 

$par.ses
          xi        sigma           mu 
         NaN          NaN 2.000364e-06 

$varcov
              [,1]          [,2]          [,3]
[1,] -3.869327e-04 -1.577656e-03 -2.376900e-11
[2,] -1.577656e-03 -6.545925e-03 -1.183534e-10
[3,] -2.376900e-11 -1.183534e-10  4.001455e-12

$converged
[1] 0

$nllh.final
[1] 369.0776

attr(,"class")
[1] "gev"

```



```python
seed=1234
np.random.seed(seed)
random.seed(seed)
rvs = genextreme.rvs(c=-2 ,loc=3,scale=0.5,size=100)
c,loc,scale = genextreme.fit(rvs)
print(-c,loc,scale)
print(rvs)
```

```python
[2.84152028e+00 3.85971316e+00 3.11628034e+00 7.03245381e+00
 6.79868394e+00 2.89797978e+00 2.90124411e+00 7.87764580e+00
 1.39467153e+02 1.69972341e+01 2.98668980e+00 3.27334031e+00
 4.47600312e+00 4.92936760e+00 3.00324384e+00 3.49913181e+00
 3.27969614e+00 2.76361326e+00 6.51451752e+00 1.87919348e+01
 2.99596435e+00 3.81067217e+00 2.78740699e+00 3.00128710e+00
 5.49570005e+01 4.11051733e+00 3.04325539e+00 7.18844580e+00
 2.93924301e+00 3.53187250e+00 1.54568481e+01 3.11314641e+00
 7.89363539e+00 2.81645573e+00 4.78376417e+00 4.78905022e+00
 2.85825860e+00 4.37313407e+01 3.12533972e+00 3.04143280e+01
 2.78151310e+00 2.83740152e+00 2.77687314e+00 4.36685493e+00
 3.67517991e+00 3.38258554e+00 2.77537140e+00 3.50022758e+00
 2.95302710e+00 3.27933970e+00 2.80211614e+00 3.75438469e+00
 3.52147203e+00 2.76001549e+00 3.82532200e+00 3.22993523e+01
 7.27465940e+00 3.95823809e+03 1.43995821e+02 7.34554504e+00
 2.90888309e+00 3.88107476e+00 3.20907970e+00 2.84394480e+00
 3.02041939e+00 2.77929836e+00 3.14570203e+00 7.60889893e+02
 2.80734634e+00 2.80534061e+00 5.47119498e+00 3.63260933e+00
 3.19260705e+00 2.80010419e+00 2.86520936e+00 2.52542981e+01
 3.07633645e+00 3.39226307e+00 2.75968053e+00 2.92308106e+00
 3.11459399e+00 3.78792760e+00 3.70751875e+01 3.88741062e+00
 4.81264007e+00 2.81938135e+00 5.66318971e+00 1.00453658e+01
 3.95156059e+00 3.11746166e+00 2.82072482e+00 3.53338801e+00
 3.36373332e+00 1.03593449e+02 3.21501828e+00 3.27809400e+00
 3.39622169e+00 9.03612451e+00 2.78050670e+00 4.30207582e+00]

xi:0.985006196939567 mu:3.0928381601146153 sigma:0.4664235019412498
```



# GPD

```R
library(evir)
set.seed(1234)
data<-rgpd(100,xi=1,mu=3,beta=2)
out1<-gpd(data,0)
print(out1)
```

```R
$n
[1] 100

$data
  [1]   3.256581   6.295199   6.118686   6.310385  15.379736   6.560353   3.019174   3.606035   6.989526   5.117354
 [11]   7.527230   5.395361   3.788364  27.121079   3.826119  13.292233   3.801997   3.727846   3.459186   3.604933
 [21]   3.926597   3.868179   3.378251   3.083324   3.560162  11.559581   5.216719  24.435165  12.858531   3.095931
 [31]   4.677089   3.721780   3.876341   5.059322   3.442289   9.321913   3.503906   3.698363 255.790622  11.381647
 [41]   5.477615   6.656206   3.906235   6.288476   3.984051   5.016044   7.193763   4.883429   3.645254   9.527322
 [51]   3.159314   3.897235   8.073930   5.036701   3.361272   5.031717   4.952264   9.038592   3.423214  14.191952
 [61]  15.796602   3.087372   3.929039   3.027883   3.628210   7.814185   3.890569   5.069570   3.108919   5.593159
 [71]   3.276557  19.663050   3.029689  10.221736   3.197709   5.159647   4.248159   3.150659   3.943966   7.033099
 [81]  28.174089   4.787231   3.332675   5.388561   3.488103  20.720071   4.276002   3.902213   3.381034  20.265196
 [91]   3.399214  21.085281   3.309677   3.303124   3.235355   5.094866   3.857956   3.054901   3.897070   8.755535

$threshold
[1] 0

$p.less.thresh
[1] 0

$n.exceed
[1] 100

$method
[1] "ml"

$par.ests
       xi      beta 
0.2109841 6.3075499 

$par.ses
        xi       beta 
0.07273328 0.76853847 

$varcov
            [,1]        [,2]
[1,]  0.00529013 -0.01724425
[2,] -0.01724425  0.59065138

$information
[1] "observed"

$converged
[1] 0

$nllh.final
[1] 305.2583

attr(,"class")
[1] "gpd"
```



```python
seed=1234
np.random.seed(seed)
random.seed(seed)
data=[3.256581  , 6.295199 ,  6.118686 ,  6.310385 , 15.379736 ,  6.560353 ,  3.019174 ,  3.606035 ,  6.989526 ,  5.117354,
7.527230  , 5.395361 ,  3.788364 , 27.121079 ,  3.826119 , 13.292233 ,  3.801997 ,  3.727846 ,  3.459186 ,  3.604933,
3.926597  , 3.868179 ,  3.378251 ,  3.083324 ,  3.560162 , 11.559581 ,  5.216719 , 24.435165 , 12.858531 ,  3.095931,
4.677089  , 3.721780 ,  3.876341 ,  5.059322 ,  3.442289 ,  9.321913 ,  3.503906 ,  3.698363 ,255.790622 , 11.381647,
5.477615  , 6.656206 ,  3.906235 ,  6.288476 ,  3.984051 ,  5.016044 ,  7.193763 ,  4.883429 ,  3.645254 ,  9.527322,
3.159314  , 3.897235 ,  8.073930 ,  5.036701 ,  3.361272 ,  5.031717 ,  4.952264 ,  9.038592 ,  3.423214 , 14.191952,
15.796602 ,  3.087372,   3.929039,   3.027883,   3.628210,   7.814185,   3.890569,   5.069570,   3.108919,   5.593159,
3.276557  ,19.663050 ,  3.029689 , 10.221736 ,  3.197709 ,  5.159647 ,  4.248159 ,  3.150659 ,  3.943966 ,  7.033099,
28.174089 ,  4.787231,   3.332675,   5.388561,   3.488103,  20.720071,   4.276002,   3.902213,   3.381034,  20.265196,
3.399214  ,21.085281 ,  3.309677 ,  3.303124 ,  3.235355 ,  5.094866 ,  3.857956 ,  3.054901 ,  3.897070 ,  8.755535]
data=np.array(data)

c,loc,scale = genpareto.fit(data)
print(c,loc,scale)
```

```python
0.8365465700309074 3.0191739996924105 1.469340878072087
```





```python
rvs = genpareto.rvs(c=1,loc=3,scale=2,size=100)
c,loc,scale = genpareto.fit(data)
print(c,loc,scale)
print(rvs)
```

```pyton
xi:0.8365465700309074 loc:3.0191739996924105 sigma:1.469340878072087
[  3.47377627   6.29252824   4.55699567  10.31786621  10.08990954
   3.74949088   3.76420345  11.09449342  48.77757096  17.12027463
   4.11437836   5.00797688   7.31837539   7.96141354   4.17586724
   5.55784553   5.02481836   3.02792133   9.80384847  18.04175435
   4.14904088   6.20015634   3.16305367   4.16868832  30.9132972
   6.73687496   4.31786422  10.46656578   3.92755525   5.63068711
  16.28203643   4.54719001  11.10854771   3.33581232   7.76271917
   7.77005232   3.56013798  27.61968421   4.58513374  23.05459723
   3.12722784   3.451843     3.09941855   7.15159266   5.93370068
   5.28550151   3.09057208   5.56030747   3.98359817   5.02387634
   3.25198424   6.09156811   5.60770722   3.01362025   6.22796145
  23.75905431  10.54763921 253.57200987  49.54576566  10.61372695
   3.79818494   6.33214896   4.8321062    3.4865576    4.23790919
   3.11388265   4.64729497 112.14038748   3.28295569   3.27112948
   8.64885795   5.84617787   4.78524442   3.23995976   3.5947693
  20.99304139   4.42908209   5.30896728   3.01249461   3.85976447
   4.55172394   6.15661938  25.4493025    6.34383104   7.80266475
   3.35248096   8.87598193  12.8348092    6.46038959   4.56068219
   3.36008467   5.63402353   5.2393025   42.17663363   4.84881233
   5.02058187   5.3185183   12.06207337   3.12115089   7.05000468]
```



```R
library(evir)
set.seed(1234)
data=c(3.47377627,   6.29252824,   4.55699567,  10.31786621,
        10.08990954,   3.74949088,   3.76420345,  11.09449342,
        48.77757096,  17.12027463,   4.11437836,   5.00797688,
         7.31837539,   7.96141354,   4.17586724,   5.55784553,
         5.02481836,   3.02792133,   9.80384847,  18.04175435,
         4.14904088,   6.20015634,   3.16305367,   4.16868832,
        30.9132972 ,   6.73687496,   4.31786422,  10.46656578,
         3.92755525,   5.63068711,  16.28203643,   4.54719001,
        11.10854771,   3.33581232,   7.76271917,   7.77005232,
         3.56013798,  27.61968421,   4.58513374,  23.05459723,
         3.12722784,   3.451843  ,   3.09941855,   7.15159266,
         5.93370068,   5.28550151,   3.09057208,   5.56030747,
         3.98359817,   5.02387634,   3.25198424,   6.09156811,
         5.60770722,   3.01362025,   6.22796145,  23.75905431,
        10.54763921, 253.57200987,  49.54576566,  10.61372695,
         3.79818494,   6.33214896,   4.8321062 ,   3.4865576 ,
         4.23790919,   3.11388265,   4.64729497, 112.14038748,
         3.28295569,   3.27112948,   8.64885795,   5.84617787,
         4.78524442,   3.23995976,   3.5947693 ,  20.99304139,
         4.42908209,   5.30896728,   3.01249461,   3.85976447,
         4.55172394,   6.15661938,  25.4493025 ,   6.34383104,
         7.80266475,   3.35248096,   8.87598193,  12.8348092 ,
         6.46038959,   4.56068219,   3.36008467,   5.63402353,
         5.2393025 ,  42.17663363,   4.84881233,   5.02058187,
         5.3185183 ,  12.06207337,   3.12115089,   7.05000468)
out1<-gpd(data,0)
print(out1)
```

```R
$n
[1] 100

$data
  [1]   3.256581   6.295199   6.118686   6.310385  15.379736   6.560353   3.019174   3.606035   6.989526   5.117354
 [11]   7.527230   5.395361   3.788364  27.121079   3.826119  13.292233   3.801997   3.727846   3.459186   3.604933
 [21]   3.926597   3.868179   3.378251   3.083324   3.560162  11.559581   5.216719  24.435165  12.858531   3.095931
 [31]   4.677089   3.721780   3.876341   5.059322   3.442289   9.321913   3.503906   3.698363 255.790622  11.381647
 [41]   5.477615   6.656206   3.906235   6.288476   3.984051   5.016044   7.193763   4.883429   3.645254   9.527322
 [51]   3.159314   3.897235   8.073930   5.036701   3.361272   5.031717   4.952264   9.038592   3.423214  14.191952
 [61]  15.796602   3.087372   3.929039   3.027883   3.628210   7.814185   3.890569   5.069570   3.108919   5.593159
 [71]   3.276557  19.663050   3.029689  10.221736   3.197709   5.159647   4.248159   3.150659   3.943966   7.033099
 [81]  28.174089   4.787231   3.332675   5.388561   3.488103  20.720071   4.276002   3.902213   3.381034  20.265196
 [91]   3.399214  21.085281   3.309677   3.303124   3.235355   5.094866   3.857956   3.054901   3.897070   8.755535

$threshold
[1] 0

$p.less.thresh
[1] 0

$n.exceed
[1] 100

$method
[1] "ml"

$par.ests
       xi      beta 
0.2109841 6.3075499 

$par.ses
        xi       beta 
0.07273328 0.76853847 

$varcov
            [,1]        [,2]
[1,]  0.00529013 -0.01724425
[2,] -0.01724425  0.59065138

$information
[1] "observed"

$converged
[1] 0

$nllh.final
[1] 305.2583

attr(,"class")
[1] "gpd"
```

